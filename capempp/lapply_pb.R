lapply_pb <- function(X, FUN, ...){
	env <- environment()
	pb_Total <- length(X)
	counter <- 0
	pb <- txtProgressBar(min = 0, max = pb_Total, style = 3)
	
	# wrapper around FUN
		wrapper <- function(...){
		curVal <- get("counter", envir = env)
		assign("counter", curVal +1 ,envir=env)
		setTxtProgressBar(get("pb", envir=env), curVal +1)
		FUN(...)
		}
	res <- lapply(X, wrapper, ...)
	close(pb)
	res
	}
